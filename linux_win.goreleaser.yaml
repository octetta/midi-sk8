version: 2
project_name: midi-sk8

builds:
  - id: linux
    main: .
    goos: [linux]
    goarch: [amd64]
    env:
      - CGO_ENABLED=1
    ldflags:
      - -s -w -X main.version={{.Version}}

  - id: windows
    main: .
    goos: [windows]
    goarch: [amd64]
    env:
      - CGO_ENABLED=1
      - CC=x86_64-w64-mingw32-gcc
      - CXX=x86_64-w64-mingw32-g++
    ldflags:
      - -s -w -H=windowsgui -X main.version={{.Version}}
      - -extldflags "-static -static-libgcc -static-libstdc++"

archives:
  - name_template: "midi-sk8_{{ .Version }}_{{ .Os }}_{{ .Arch }}"
    format: tar.gz
    format_overrides:
      - goos: windows
        format: zip

changelog:
  sort: asc
  filters:
    exclude:
      - '^docs:'
      - '^test:'
  groups:
    - title: 'New Features'
      regexp: "^.*feat[(\\w)]*:+.*$"
      order: 0
    - title: 'Fixes'
      regexp: "^.*fix[(\\w)]*:+.*$"
      order: 1
    - title: 'Build & CI'
      regexp: "^.*build[(\\w)]*:+.*$"
      order: 2
